#!/usr/bin/env sh
set -eu

printf 'Beginning upgrade.\n'

if [ "$(which pacman > /dev/null 2>&1)" ]; then
    echo "Arch"
    paru -Syu
    pkill -RTMIN+8 "dwmblocks"
    printf '\nUpgrade complete.\nPress \033[0;32m<Enter>\033[0m to exit window.\n\n'
    read -r _
else
    # Run the current script as root with all the arguments if not already being ran as root
    if [ "$(id -u)" -ne "0" ]; then exec sudo "$0" "$@"; fi

    eix-sync

    printf '\nTo continue, press \033[0;32m<Enter>\033[0m.\n\n'
    read -r _

    clear
    emerge -auDU --with-bdeps=y @world
    printf '\nUpgrade complete.\nPress \033[0;32m<Enter>\033[0m to exit window.\n\n'
    read -r _
fi
